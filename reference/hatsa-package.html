<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>hatsa: Hyperalignment via Task-informed Shared Analysis — hatsa-package • hatsa</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="hatsa: Hyperalignment via Task-informed Shared Analysis — hatsa-package"><meta name="description" content="Implements advanced hyperalignment methods for functional neuroimaging data with task-informed features. Provides sparse graph-based alignment of functional connectivity patterns across subjects using spectral decomposition and Procrustes alignment. Includes extensions for task-informed alignment, Riemannian geometry operations on SPD manifolds, and voxel-level projection via Nyström extension.
The `hatsa` package implements the Core HATSA (Hybrid Anchor-based
Time-Series Alignment) algorithm. This algorithm is designed to align
functional connectivity patterns, represented as spectral sketches derived
from graph Laplacians, across multiple subjects. It leverages anchor parcels
and Generalized Procrustes Analysis for robust alignment, employing sparse
matrix operations for computational efficiency."><meta property="og:description" content="Implements advanced hyperalignment methods for functional neuroimaging data with task-informed features. Provides sparse graph-based alignment of functional connectivity patterns across subjects using spectral decomposition and Procrustes alignment. Includes extensions for task-informed alignment, Riemannian geometry operations on SPD manifolds, and voxel-level projection via Nyström extension.
The `hatsa` package implements the Core HATSA (Hybrid Anchor-based
Time-Series Alignment) algorithm. This algorithm is designed to align
functional connectivity patterns, represented as spectral sketches derived
from graph Laplacians, across multiple subjects. It leverages anchor parcels
and Generalized Procrustes Analysis for robust alignment, employing sparse
matrix operations for computational efficiency."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hatsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/core-hatsa-toy-example.html">Core HATSA with a Toy-Connectome</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with HATSA</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbuchsbaum/hatsa/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>hatsa: Hyperalignment via Task-informed Shared Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/hatsa/blob/main/R/hatsa-package.R" class="external-link"><code>R/hatsa-package.R</code></a></small>
      <div class="d-none name"><code>hatsa-package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements advanced hyperalignment methods for functional neuroimaging data with task-informed features. Provides sparse graph-based alignment of functional connectivity patterns across subjects using spectral decomposition and Procrustes alignment. Includes extensions for task-informed alignment, Riemannian geometry operations on SPD manifolds, and voxel-level projection via Nyström extension.</p>
<p>The `hatsa` package implements the Core HATSA (Hybrid Anchor-based
Time-Series Alignment) algorithm. This algorithm is designed to align
functional connectivity patterns, represented as spectral sketches derived
from graph Laplacians, across multiple subjects. It leverages anchor parcels
and Generalized Procrustes Analysis for robust alignment, employing sparse
matrix operations for computational efficiency.</p>
    </div>


    <div class="section level2">
    <h2 id="core-hatsa-algorithm">Core HATSA Algorithm<a class="anchor" aria-label="anchor" href="#core-hatsa-algorithm"></a></h2>


<p>The primary function is <code><a href="run_hatsa_core.html">run_hatsa_core</a></code>. It processes
subject-specific time-series data and alignment parameters to produce:</p><ul><li><p>Original spectral sketches for each subject.</p></li>
<li><p>Aligned spectral sketches for each subject.</p></li>
<li><p>The corresponding rotation matrices (in SO(k)) used for alignment.</p></li>
</ul><p>The algorithm follows three main stages:
1.  **Initial Spectral Sketching (per subject):**</p><ul><li><p>A correlation matrix is computed from the time-series.</p></li>
<li><p>This graph is sparsified based on strongest positive/negative
            connections per parcel.</p></li>
<li><p>The sparsified graph is symmetrized using a weighted averaging scheme.</p></li>
<li><p>Non-zero edge weights of the symmetrized graph are z-scored,
            ensuring symmetry is preserved.</p></li>
<li><p>A sparse graph Laplacian (`L = D - W`) is constructed.</p></li>
<li><p>The `k` eigenvectors corresponding to the smallest, non-zero
            eigenvalues of `L` form the subject's original spectral sketch.
            Eigenvectors for eigenvalues numerically close to zero are discarded.
            This step uses efficient methods for sparse matrices.</p></li>
</ul><p>2.  **Iterative Refinement (Generalized Procrustes Analysis - GPA):**</p><ul><li><p>Rows corresponding to pre-defined anchor parcels are extracted from
            each subject's original spectral sketch.</p></li>
<li><p>A group anchor template is initialized (typically as the mean of
            subjects' anchor sketches).</p></li>
<li><p>Iteratively:</p><ul><li><p>Subject-specific orthogonal rotation matrices (`R_i  SO(k)`)
                    are computed to best align each subject's anchor sketch to the
                    current group template (Orthogonal Procrustes Problem).</p></li>
<li><p>The group anchor template is updated as the mean of the
                    subjects' rotated anchor sketches.</p></li>
</ul></li>
</ul><p>3.  **Apply Final Rotations:**</p><ul><li><p>The final rotation matrices from the GPA are applied to each
            subject's full original spectral sketch to obtain the aligned
            spectral sketches.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://bbuchsbaum.github.io/hatsa/">https://bbuchsbaum.github.io/hatsa/</a></p></li>
<li><p>Report bugs at <a href="https://github.com/bbuchsbaum/hatsa/issues" class="external-link">https://github.com/bbuchsbaum/hatsa/issues</a></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><strong>Maintainer</strong>: Brad Buchsbaum <a href="mailto:brad.buchsbaum@gmail.com">brad.buchsbaum@gmail.com</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brad Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

