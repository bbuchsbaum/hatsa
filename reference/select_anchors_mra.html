<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Manifold-Regularized Anchor Selection (MRA-Select) — select_anchors_mra • hatsa</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Manifold-Regularized Anchor Selection (MRA-Select) — select_anchors_mra"><meta name="description" content="Selects a set of anchor parcels by optimizing a criterion that balances
the stability of the mean anchor representation (via condition number) and
the dispersion of subject-specific covariance matrices derived from these anchors
on the SPD manifold."><meta property="og:description" content="Selects a set of anchor parcels by optimizing a criterion that balances
the stability of the mean anchor representation (via condition number) and
the dispersion of subject-specific covariance matrices derived from these anchors
on the SPD manifold."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hatsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/core-hatsa-toy-example.html">Core HATSA with a Toy-Connectome</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with HATSA</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbuchsbaum/hatsa/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Manifold-Regularized Anchor Selection (MRA-Select)</h1>
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/hatsa/blob/main/R/anchor_selection_mra.R" class="external-link"><code>R/anchor_selection_mra.R</code></a></small>
      <div class="d-none name"><code>select_anchors_mra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Selects a set of anchor parcels by optimizing a criterion that balances
the stability of the mean anchor representation (via condition number) and
the dispersion of subject-specific covariance matrices derived from these anchors
on the SPD manifold.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">select_anchors_mra</span><span class="op">(</span></span>
<span>  <span class="va">U_original_list_pilot</span>,</span>
<span>  <span class="va">spectral_rank_k</span>,</span>
<span>  <span class="va">m_target</span>,</span>
<span>  total_parcels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_kappa <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  weight_inv_kappa <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight_dispersion <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  initial_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  candidate_pool <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parcel_quality_info <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  riemannian_dispersion_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  min_anchors_for_metrics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-u-original-list-pilot">U_original_list_pilot<a class="anchor" aria-label="anchor" href="#arg-u-original-list-pilot"></a></dt>
<dd><p>A list of original (unaligned) sketch matrices
(V_p x k) for a set of pilot subjects. These are used to evaluate candidate anchors.</p></dd>


<dt id="arg-spectral-rank-k">spectral_rank_k<a class="anchor" aria-label="anchor" href="#arg-spectral-rank-k"></a></dt>
<dd><p>Integer, the spectral rank `k` used to generate
`U_original_list_pilot`.</p></dd>


<dt id="arg-m-target">m_target<a class="anchor" aria-label="anchor" href="#arg-m-target"></a></dt>
<dd><p>Integer, the desired number of anchors to select.</p></dd>


<dt id="arg-total-parcels">total_parcels<a class="anchor" aria-label="anchor" href="#arg-total-parcels"></a></dt>
<dd><p>Integer, the total number of parcels (V_p) available for selection.
If NULL, inferred from `U_original_list_pilot`.</p></dd>


<dt id="arg-max-kappa">max_kappa<a class="anchor" aria-label="anchor" href="#arg-max-kappa"></a></dt>
<dd><p>Numeric, the maximum allowable condition number for the mean anchor matrix.
Candidates leading to a kappa above this are penalized or excluded. Default: 100.</p></dd>


<dt id="arg-weight-inv-kappa">weight_inv_kappa<a class="anchor" aria-label="anchor" href="#arg-weight-inv-kappa"></a></dt>
<dd><p>Numeric, weight for the inverse condition number term in the score.
Higher values prioritize lower condition numbers (more stable mean). Default: 1.0.</p></dd>


<dt id="arg-weight-dispersion">weight_dispersion<a class="anchor" aria-label="anchor" href="#arg-weight-dispersion"></a></dt>
<dd><p>Numeric, weight for the negative dispersion term in the score.
Higher values prioritize lower dispersion. Default: 1.0.</p></dd>


<dt id="arg-initial-selection">initial_selection<a class="anchor" aria-label="anchor" href="#arg-initial-selection"></a></dt>
<dd><p>Optional. A vector of pre-selected anchor indices (1-based).
The algorithm will try to add `m_target - length(initial_selection)` new anchors.</p></dd>


<dt id="arg-candidate-pool">candidate_pool<a class="anchor" aria-label="anchor" href="#arg-candidate-pool"></a></dt>
<dd><p>Optional. A vector of parcel indices (1-based) from which to select
new anchors. If NULL, all non-initially-selected parcels are candidates.</p></dd>


<dt id="arg-parcel-quality-info">parcel_quality_info<a class="anchor" aria-label="anchor" href="#arg-parcel-quality-info"></a></dt>
<dd><p>Optional. Data frame or list providing parcel quality or
network information. Currently unused in the core MRA logic but reserved for future
extensions (e.g., pre-filtering candidates).</p></dd>


<dt id="arg-riemannian-dispersion-options">riemannian_dispersion_options<a class="anchor" aria-label="anchor" href="#arg-riemannian-dispersion-options"></a></dt>
<dd><p>A list of options to pass to
`hatsa::riemannian_dispersion_spd` (e.g., `spd_metric`, `use_geometric_median`).</p></dd>


<dt id="arg-min-anchors-for-metrics">min_anchors_for_metrics<a class="anchor" aria-label="anchor" href="#arg-min-anchors-for-metrics"></a></dt>
<dd><p>Integer. Minimum number of selected anchors required before
kappa and dispersion metrics are considered stable enough to compute. Default is
`spectral_rank_k`.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, print progress messages. Default: TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of selected anchor indices (1-based), sorted.</p>
    </div>
    <div class="section level2">
    <h2 id="methodological-details">Methodological Details<a class="anchor" aria-label="anchor" href="#methodological-details"></a></h2>


<p>MRA-Select greedily optimizes a composite score balancing the
condition number of the mean anchor matrix with the Riemannian
dispersion of subject covariance matrices on the SPD manifold.
Candidate anchors that maximize this score are iteratively added
until <code>m_target</code> anchors are selected.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Conceptual example (requires U_original_list_pilot from actual or synthetic data)</span></span></span>
<span class="r-in"><span><span class="co"># N_pilot &lt;- 5</span></span></span>
<span class="r-in"><span><span class="co"># V_p_total &lt;- 50</span></span></span>
<span class="r-in"><span><span class="co"># k_rank &lt;- 10</span></span></span>
<span class="r-in"><span><span class="co"># U_pilot_list &lt;- replicate(N_pilot,</span></span></span>
<span class="r-in"><span><span class="co">#                           matrix(rnorm(V_p_total * k_rank), V_p_total, k_rank),</span></span></span>
<span class="r-in"><span><span class="co">#                           simplify = FALSE)</span></span></span>
<span class="r-in"><span><span class="co"># selected_anchors_mra &lt;- select_anchors_mra(</span></span></span>
<span class="r-in"><span><span class="co">#   U_original_list_pilot = U_pilot_list,</span></span></span>
<span class="r-in"><span><span class="co">#   spectral_rank_k = k_rank,</span></span></span>
<span class="r-in"><span><span class="co">#   m_target = 15,</span></span></span>
<span class="r-in"><span><span class="co">#   total_parcels = V_p_total,</span></span></span>
<span class="r-in"><span><span class="co">#   verbose = TRUE</span></span></span>
<span class="r-in"><span><span class="co"># )</span></span></span>
<span class="r-in"><span><span class="co"># print(selected_anchors_mra)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brad Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

