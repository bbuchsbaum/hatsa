% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/procrustes_alignment.R
\name{perform_geometric_gpa_refinement}
\alias{perform_geometric_gpa_refinement}
\title{Perform Geometric Generalized Procrustes Analysis (Geo-GPA) Refinement}
\usage{
perform_geometric_gpa_refinement(
  A_originals_list,
  n_refine,
  k,
  m_rows = NULL,
  initial_R_list = NULL,
  tol = 1e-07,
  verbose = FALSE,
  frechet_mean_options = list()
)
}
\arguments{
\item{A_originals_list}{List of `m x k` anchor matrices for `N` subjects.}

\item{n_refine}{Integer, number of refinement iterations.}

\item{k}{Integer, spectral rank (number of columns in anchor matrices).}

\item{m_rows}{Integer, number of rows in anchor matrices (anchor count).
If NULL, inferred from the first valid matrix in `A_originals_list`.}

\item{initial_R_list}{Optional. A list of k x k rotation matrices to start with.
If NULL, an initial `T_anchor` is computed as the mean of `A_originals_list`,
and then initial `R_list` is computed by aligning each `A_original` to this `T_anchor`.}

\item{tol}{Numeric, tolerance for convergence based on the change in the Frobenius
norm of `R_bar` (the Fréchet mean of rotations). Default: 1e-7.}

\item{verbose}{Logical, if TRUE, prints progress messages. Default: FALSE.}

\item{frechet_mean_options}{A list of options to pass to `hatsa::frechet_mean_so_k`,
such as `max_iter`, `tol` (for its internal convergence), `project_to_SOk`.}
}
\value{
List: `R_final_list` (list of `k x k` rotation matrices),
        `T_anchor_final` (final `m x k` group anchor template, geometrically derived),
        `R_bar_final` (final `k x k` Fréchet mean of the rotations).
}
\description{
Iteratively refines subject rotations and a group anchor template using a
geometric approach on SO(k) for rotation averaging.
The consensus anchor template `T_anchor_geo` is formed by averaging subject
anchor matrices after they have been rotated to a common orientation defined
by the Fréchet mean of their current rotation estimates (`R_bar`).
}
\keyword{internal}
